<!-- This layout is used in all pages. Making changes here will efect all pages. We recommend not to change anything here. --> <!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="dns-prefetch" href="//fonts.googleapis.com" /><link rel="dns-prefetch" href="//google-analytics.com" /><link rel="dns-prefetch" href="//www.google-analytics.com" /><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com" /><link rel="dns-prefetch" href="//ajax.googleapis.com" /><link rel="dns-prefetch" href="//fonts.gstatic.com" /><title>Redline InfoStealer Malware Analysis with Wireshark | My Portfolio</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Redline InfoStealer Malware Analysis with Wireshark" /><meta property="og:locale" content="en_US" /><meta name="description" content="Background" /><meta property="og:description" content="Background" /><link rel="canonical" href="http://localhost:4000/projects/personal/malware-analysis/redline-infostealer-analysis/" /><meta property="og:url" content="http://localhost:4000/projects/personal/malware-analysis/redline-infostealer-analysis/" /><meta property="og:site_name" content="My Portfolio" /><meta property="og:image" content="http://localhost:4000/assets/images/thumbnails/malware-analysis/redline-malware-analysis.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-03-28T00:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/images/thumbnails/malware-analysis/redline-malware-analysis.jpg" /><meta property="twitter:title" content="Redline InfoStealer Malware Analysis with Wireshark" /><script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-03-28T00:00:00-04:00","datePublished":"2024-03-28T00:00:00-04:00","description":"Background","headline":"Redline InfoStealer Malware Analysis with Wireshark","image":"http://localhost:4000/assets/images/thumbnails/malware-analysis/redline-malware-analysis.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/personal/malware-analysis/redline-infostealer-analysis/"},"url":"http://localhost:4000/projects/personal/malware-analysis/redline-infostealer-analysis/"}</script><link rel="stylesheet" href="/assets/css/main-default.css" /><link id="color-scheme" rel="stylesheet" href="/assets/css/main-default.css" /><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-icon-60x60.png" /><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-icon-114x114.png" /><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-icon-152x152.png" /><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/android-icon-192x192.png" /><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><link rel="icon" href="/favicon.ico" type="image/x-icon" /><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" ></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script></head><body><div class="loader"><div class="lds-ring"><div></div><div></div><div></div><div></div></div></div><div class="wrapper"><div class="container-grid"><div class="sidebar"><div class="author-container shadow"><div class="author"> <a href="/"> <img src="/assets/images/headshots/professional-hs.jpg" width="100%" height="auto;" alt="My Portfolio"loading="lazy" /> </a></div><div class="about text-center"><h1 class="title"><a href="/">Ethan Epperson</a></h1></div><div class="bio text-center"><p class="m0">Cybersecurity Student | Let's Defend Together</p></div><hr class="dashed"><div class="social text-center"> <ul class="portfolio p0"> <li><a href="/projects/">Projects</a></li> <li><a href="/blog/">Blog</a></li> <li><a href="/contact/">Contact</a></li> </ul> <ul class="sm p0 m0a"> <li><a href="https://www.linkedin.com/in/ethan-epperson-8608b5277"><i class="fa fa-linkedin"></i></a></li> <li><a href="https://www.github.com/EEpp14"><i class="fa fa-github"></i></a></li> </ul></div></div></div><div class="main"><div class="main-container shadow"><div class="title-space"> <h1>Redline InfoStealer Malware Analysis with Wireshark</h1><div class="input-group mb-3" data-aos="zoom-in"> <input type="text" class="form-control border-right-0" id="search-input" /><div class="input-group-append"> <span class="input-group-text" ><i class="fa fa-search"></i ></span></div></div></div><hr class="dashed" /> <main> <ul class="breadcrumbs"> <li><a href="/">Home</a></li> <li> <a href="/projects" >Projects</a > </li> <li> <a href="/projectspersonal" >Personal</a > </li> <li> <a href="/projectspersonalmalware-analysis" >Malware analysis</a > </li> <li> <a href="#" >Redline infosteal...</a > </li> </ul><div class="meta" data-aos="fade-up"> <p> <small> <span> <i class="fa fa-calendar" aria-hidden="true"></i> 28 Mar 2024&nbsp; </span> <span> <i class="fa fa-user" aria-hidden="true"></i> &nbsp; </span> <span> <i class="fa fa-clock-o" aria-hidden="true"></i> 4 mins read. </span> </small> </p></div><div class="featured-image rounded shadow" style="background-image: url(/assets/images/thumbnails/malware-analysis/redline-malware-analysis.jpg)" data-aos="zoom-in" ></div><div class="container"> <article> <ul class="toc"> <li><a href="#background">Background</a> <ul> <li><a href="#local-area-network-lan-details">Local Area Network (LAN) Details</a></li> <li><a href="#quiz-questions">Quiz Questions</a></li> </ul> </li> <li><a href="#confirmation-of-malware-breach">Confirmation of Malware Breach</a> <ul> <li><a href="#dns--virustotal-analysis">DNS &amp; Virustotal Analysis</a></li> <li><a href="#http-analysis">HTTP Analysis</a></li> <li><a href="#further-investigation">Further Investigation</a></li> </ul> </li> <li><a href="#answering-the-lab-questions">Answering the Lab Questions</a> <ul> <li><a href="#question-1">Question 1</a></li> <li><a href="#question-2">Question 2</a></li> <li><a href="#question-3">Question 3</a></li> <li><a href="#question-4">Question 4</a></li> <li><a href="#question-5">Question 5</a></li> <li><a href="#question-6">Question 6</a></li> </ul> </li> </ul> <h1 id="background">Background</h1> <p>This project involves analyzing a malicious packet capture containing Redline Stealer malware. Redline Stealer is a remote access trojan, meaning that attackers are able to use this malware to detect, collect, and transfer sensitive user information such as stored passwords, bookmarks, credit card information, and more. Redline Stealer was first discovered in a phishing campaign that targeted healthcare email services. It is often deployed against the manufacturing and healthcare industries.</p> <p>The pcap file and questions for this exercise was provided by <a href="/https://unit42.paloaltonetworks.com/wireshark-quiz-redline-stealer/">Palo Alto Networks</a>.</p> <h2 id="local-area-network-lan-details">Local Area Network (LAN) Details</h2> <ul> <li>What is the date and time in UTC when the infection started?</li> <li>What is the IP address of the infected Windows client?</li> <li>What is the MAC address of the infected Windows client?</li> <li>What is the hostname of the infected Windows client?</li> <li>What is the user account name from the infected Windows host?</li> <li>What type of information did this RedLine Stealer try to steal?</li> </ul> <h2 id="quiz-questions">Quiz Questions</h2> <ul> <li>What is the date and time in UTC when the infection started?</li> <li>What is the IP address of the infected Windows client?</li> <li>What is the MAC address of the infected Windows client?</li> <li>What is the hostname of the infected Windows client?</li> <li>What is the user account name from the infected Windows host?</li> <li>What type of information did this RedLine Stealer try to steal?</li> </ul> <h1 id="confirmation-of-malware-breach">Confirmation of Malware Breach</h1> <h2 id="dns--virustotal-analysis">DNS &amp; Virustotal Analysis</h2> <p>Through DNS filtering in Wireshark, I was able to find some suspicious URLs &amp; IP addresses. I used <a href="/https://www.virustotal.com/gui/home/upload">Virustotal</a> to determine if these addresses were indeed malicious and the results did not disappoint. The first URL, ‘start623.site’, was flagged by 14/90 vendors as malicious. The second URL, ‘guiatelefonos.com’, was confirmed as the domain used for Redline malware payload delivery by ArcSight Threat Intelligence.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-wireshark-dns.jpg" alt="Redline Wireshark DNS Filtering" /></p> <h2 id="http-analysis">HTTP Analysis</h2> <p>I then used a filter to search for HTTP packets associated with the IP addresses of ‘195.161.114.3’ and ‘92.118.151.9’, the two IP addresses of the malicious domains. I followed the TCP stream for a GET Request with the source 10.7.10.47 and the destination 195.161.114.3.</p> <p>It revealed some suspicious activity. The use of PowerShell in the User-Agent string suggests that some automated or scripted activity is taking place which is unusual for regular web browsing activities. The contradictory response codes suggest some form of obfuscation as to the true nature of the server’s response. All key indicators that something malicious is afoot.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-wireshark-tcpstream.jpg" alt="Redline HTTP GET Analysis 2" /></p> <p>I then followed another TCP stream from 10.7.10.47 to 92.118.151.9, another HTTP GET request. It’s a simple request for an image file, but the 301 error suggests that the file has been moved. This one could also be cause for concern. The seemingly innocent image file, czx.jpg could be a way for attackers to disguise the true nature of a malware payload. The connection might be set to keep-alive in order to have continuous data transfer.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-wireshark-tcpstream2.jpg" alt="Redline HTTP GET Analysis 2" /></p> <h2 id="further-investigation">Further Investigation</h2> <p>I jumped to the next TCP stream and noticed a new destination IP address of 194.26.135.119. Virustotal gives us some key information about this IP address. It has been marked as malicious by 15/90 vendors and is related to a Redline Stealer botnet C2 server.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-virustotal4.jpg" alt="Redline Virustotal analysis 194.26.135.119 Detection" /></p> <p>By viewing the relations tab, I was able to see some of the files that are considered indicators of a compromise. ‘czx.jpg’ was one such indicator at one point, although it no longer appears to be as of the date this project report is being posted. With that, I was able to confirm that our host had indeed been compromised by Redline malware.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-virustotal5.jpg" alt="Redline Virustotal analysis 194.26.135.119 Relations" /></p> <h1 id="answering-the-lab-questions">Answering the Lab Questions</h1> <h2 id="question-1">Question 1</h2> <p>The time of infection is revealed by the first HTTP Get Request. I discovered it was on 2023-07-10 at 22:39:47 (10:39 PM).</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-question1.jpg" alt="Redline Lab Question 1" /></p> <h2 id="question-2">Question 2</h2> <p>The host IP address, aka the victim IP address, is 10.7.10.47.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-question2.jpg" alt="Redline Lab Question 2" /></p> <h2 id="question-3">Question 3</h2> <p>The same packet reveals the MAC address of the victim source IP. I discovered that it was 80:865b:ab:1e:c4.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-question3.jpg" alt="Redline Lab Question 3" /></p> <h2 id="question-4">Question 4</h2> <p>I filtered by ‘kerberos’, since Kerboros packets usually reveal the computer name of the host. I found an error message packet near the end of tcp stream 46 and followed it. I was able to determine the computer name as ‘desktop-9pea63h’.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-question4.jpg" alt="Redline Lab Question 4" /></p> <h2 id="question-5">Question 5</h2> <p>I followed tcp.stream eq 71 starting at frame 1697 to see everything that was being passed from the victim’s computer to the malware control center. I hoped this would reveal the user account, and I was correct. The user account name is ‘rwalter’.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-question5.jpg" alt="Redline Lab Question 5" /></p> <h2 id="question-6">Question 6</h2> <p>Redline pretty much stole whatever it could. It appears to have stolen user data for several browsers such as Chrome, Opera, Vivaldi, and Yandex, data for several crypto wallets, assorted files from the documents folder, files on the desktop, and other user data from various programs.</p> <p><img src="/assets/images/personal/malware-analysis/redline-stealer/redline-question6.jpg" alt="Redline Lab Question 6" /></p> </article></div><hr class="dashed" /><div class="container"><div class="row"><div class="col-md-12"> <p class="categories" data-aos="fade-up"> </p></div></div><div class="recent" data-aos="fade-up"><div class=""> <h3>Recent Articles</h3></div><div class="recent-grid"><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-wazuh/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-wazuh.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Monitoring Suricata/Windows Logs With Wazuh</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-suricata/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Suricata Setup on pfSense with Snort Alerts</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest-pt.2/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 2</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 1</small></p></div></a></div></div></div></div></main><div id="search-container"></div><hr class="dashed" /><footer data-aos="fade-up"><div class="text-right"> <p class="copy"> <i class="fa fa-at"></i> 2018 <a class="rev" href="/">Blackcurrant</a> </p></div></footer></div></div></div></div><script src="/assets/js/jQuery.min.js"></script><script> $(document).ready(function () { $(".loader").hide(); });</script><script> (function () { var css = document.createElement("link"); css.href = "/assets/font-awesome-4.7.0/css/font-awesome.min.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css" /> </noscript><script> $("#search-input").keyup(function () { $("main").hide(); $("search-container").show(); if (!$("#search-input").val()) { $("main").show(); $("search-container").hide(); } });</script><script src="/assets/js/jekyll-search.min.js"></script><script> SimpleJekyllSearch({ searchInput: document.getElementById("search-input"), resultsContainer: document.getElementById("search-container"), searchResultTemplate: '<a class="nostyle" href="{url}"><div class="blog borders cards"><div class="image" style="background-image: url({image});"></div><div class="content"><h3 class="title">{title}</h3><p class="description">{description}</p></div></div></a>', noResultsText: "No results found", json: "/search.json", });</script><script> (function () { var css = document.createElement("link"); css.href = "https://unpkg.com/aos@2.3.1/dist/aos.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/animate-on-scroll/aos.min.css" /> </noscript><script src="/assets/animate-on-scroll/aos.min.js"></script><script> AOS.init({ duration: 600, once: true, disable: "mobile", });</script></body></html>