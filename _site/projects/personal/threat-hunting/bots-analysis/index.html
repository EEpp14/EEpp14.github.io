<!-- This layout is used in all pages. Making changes here will efect all pages. We recommend not to change anything here. --> <!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="dns-prefetch" href="//fonts.googleapis.com" /><link rel="dns-prefetch" href="//google-analytics.com" /><link rel="dns-prefetch" href="//www.google-analytics.com" /><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com" /><link rel="dns-prefetch" href="//ajax.googleapis.com" /><link rel="dns-prefetch" href="//fonts.gstatic.com" /><title>Boss of the SOC (BOTSv3) Threat Hunting and Incident Analysis | My Portfolio</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Boss of the SOC (BOTSv3) Threat Hunting and Incident Analysis" /><meta property="og:locale" content="en_US" /><meta name="description" content="Background" /><meta property="og:description" content="Background" /><link rel="canonical" href="https://eepp14.github.io/projects/personal/threat-hunting/bots-analysis/" /><meta property="og:url" content="https://eepp14.github.io/projects/personal/threat-hunting/bots-analysis/" /><meta property="og:site_name" content="My Portfolio" /><meta property="og:image" content="https://eepp14.github.io/assets/images/thumbnails/incident-response/splunk-bots.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-04-07T00:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://eepp14.github.io/assets/images/thumbnails/incident-response/splunk-bots.jpg" /><meta property="twitter:title" content="Boss of the SOC (BOTSv3) Threat Hunting and Incident Analysis" /><script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-04-07T00:00:00-04:00","datePublished":"2024-04-07T00:00:00-04:00","description":"Background","headline":"Boss of the SOC (BOTSv3) Threat Hunting and Incident Analysis","image":"https://eepp14.github.io/assets/images/thumbnails/incident-response/splunk-bots.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://eepp14.github.io/projects/personal/threat-hunting/bots-analysis/"},"url":"https://eepp14.github.io/projects/personal/threat-hunting/bots-analysis/"}</script><link rel="stylesheet" href="/assets/css/main-default.css" /><link id="color-scheme" rel="stylesheet" href="/assets/css/main-default.css" /><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-icon-60x60.png" /><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-icon-114x114.png" /><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-icon-152x152.png" /><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/android-icon-192x192.png" /><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><link rel="icon" href="/favicon.ico" type="image/x-icon" /><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" ></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script></head><body><div class="loader"><div class="lds-ring"><div></div><div></div><div></div><div></div></div></div><div class="wrapper"><div class="container-grid"><div class="sidebar"><div class="author-container shadow"><div class="author"> <a href="/"> <img src="/assets/images/headshots/professional-hs.jpg" width="100%" height="auto;" alt="My Portfolio"loading="lazy" /> </a></div><div class="about text-center"><h1 class="title"><a href="/">Ethan Epperson</a></h1></div><div class="bio text-center"><p class="m0">Cybersecurity Student | Let's Defend Together</p></div><hr class="dashed"><div class="social text-center"> <ul class="portfolio p0"> <li><a href="/projects/">Projects</a></li> <li><a href="/blog/">Blog</a></li> <li><a href="/contact/">Contact</a></li> </ul> <ul class="sm p0 m0a"> <li><a href="https://www.linkedin.com/in/ethan-epperson-8608b5277"><i class="fa fa-linkedin"></i></a></li> <li><a href="https://www.github.com/EEpp14"><i class="fa fa-github"></i></a></li> </ul></div></div></div><div class="main"><div class="main-container shadow"><div class="title-space"> <h1>Boss of the SOC (BOTSv3) Threat Hunting and Incident Analysis</h1><div class="input-group mb-3" data-aos="zoom-in"> <input type="text" class="form-control border-right-0" id="search-input" /><div class="input-group-append"> <span class="input-group-text" ><i class="fa fa-search"></i ></span></div></div></div><hr class="dashed" /> <main> <ul class="breadcrumbs"> <li><a href="/">Home</a></li> <li> <a href="/projects" >Projects</a > </li> <li> <a href="/projectspersonal" >Personal</a > </li> <li> <a href="/projectspersonalthreat-hunting" >Threat hunting</a > </li> <li> <a href="#" >Bots analysis</a > </li> </ul><div class="meta" data-aos="fade-up"> <p> <small> <span> <i class="fa fa-calendar" aria-hidden="true"></i> 07 Apr 2024&nbsp; </span> <span> <i class="fa fa-user" aria-hidden="true"></i> &nbsp; </span> <span> <i class="fa fa-clock-o" aria-hidden="true"></i> 5 mins read. </span> </small> </p></div><div class="featured-image rounded shadow" style="background-image: url(/assets/images/thumbnails/incident-response/splunk-bots.jpg)" data-aos="zoom-in" ></div><div class="container"> <article> <ul class="toc"> <li><a href="#background">Background</a> <ul> <li><a href="#question-1-100">Question 1 (100)</a></li> <li><a href="#question-2-200">Question 2 (200)</a></li> <li><a href="#question-3-201">Question 3 (201)</a></li> <li><a href="#question-4-202">Question 4 (202)</a></li> <li><a href="#question-5-203">Question 5 (203)</a></li> <li><a href="#question-6-204">Question 6 (204)</a></li> <li><a href="#question-7-205">Question 7 (205)</a></li> <li><a href="#question-16-215">Question 16 (215)</a></li> </ul> </li> </ul> <h1 id="background">Background</h1> <p>This project involves using Splunk to parse and analyze the Boss of the SOC v3 dataset. BOTSv3 is the third dataset iteration designed by Splunk to simulate a real word enterprise environment. It let’s challengers tackle many real-world scenarios that actual security analysts have reported. I completed the challenges via <a href="/https://cyberdefenders.org">Cyberdefenders.org</a>. They offer a virtual machine with the dataset already built and ready to go. There are several series of questions beginning at 200 and ranging all the way through 300+. In this project, I will be tackling 200-207 and 215 which all deal with Amazon Web Services (AWS).</p> <h2 id="question-1-100">Question 1 (100)</h2> <p><strong>This is a simple question to get you familiar with submitting answers. What is the name of the company that makes the software that you are using for this competition? Answer guidance: A six-letter word with no punctuation.</strong></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-splunk.jpg" alt="BOTSv3 Question 1" /></p> <h2 id="question-2-200">Question 2 (200)</h2> <p><strong>List out the IAM users that accessed an AWS service (successfully or unsuccessfully) in Frothly’s AWS environment? Answer guidance: Comma separated without spaces, in alphabetical order. (Example: ajackson,mjones,tmiller)</strong></p> <p>For this questions, I found the Amazon account number associated with Frothly. After some searches, I discovered that the account number is associated with the ‘recipientAccountId’ field in Amazon’s Cloudtrail. I used this query to get the ID number.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-200a.jpg" alt="BOTSv3 Question 2a" /></p> <p>It turned up with the id of ‘622676721278’. With this I could then lookup the user accounts associated with the account ID by using the ‘userIdentity.userName’ field.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-200b.jpg" alt="BOTSv3 Question 2b" /></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-200c.jpg" alt="BOTSv3 Question 2c" /></p> <h2 id="question-3-201">Question 3 (201)</h2> <p><strong>What field would you use to alert that AWS API activity have occurred without MFA (multi-factor authentication)? Answer guidance: Provide the full JSON path. (Example: iceCream.flavors.traditional)</strong></p> <p>For this one I did some web searching and found a relevant webpage about API activity without MFA that had the specific FilterPattern that should be used.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-201a.jpg" alt="BOTSv3 Question 3a" /></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-201b.jpg" alt="BOTSv3 Question 3b" /></p> <h2 id="question-4-202">Question 4 (202)</h2> <p><strong>What is the processor number used on the web servers? Answer guidance: Include any special characters/punctuation. (Example: The processor number for Intel Core i7-8650U is i7-8650U.)</strong></p> <p>For this one, I had to nail down which events would reference hardware specifications. I ran a keyword search for Intel and AMD as most devices run with CPUs from these manufacturers. I wanted to see which sourcetypes these keywords occur in most frequently.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-202a.jpg" alt="BOTSv3 Question 4a" /></p> <p>I went through the osquery:results sourcetype and it revealed 4 events. Viewing the raw text of the first event, I found a field for ‘cpu_brand’ with the contents revealing to me the specific process number.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-202b.jpg" alt="BOTSv3 Question 4b" /></p> <p>I checked to make sure the host-id matched that of the server by going back to view the ‘stream:http’ events. I viewed the raw text for the first event and I found the confirmation I needed.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-202c.jpg" alt="BOTSv3 Question 4c" /></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-202d.jpg" alt="BOTSv3 Question 4d" /></p> <h2 id="question-5-203">Question 5 (203)</h2> <p><strong>Bud accidentally makes an S3 bucket publicly accessible. What is the event ID of the API call that enabled public access? Answer guidance: Include any special characters/punctuation.</strong></p> <p>I did some investigative web searching and found out that the specific Cloudtrail event names pertaining to bucket ACL changes and bucket policy changes. I then used this to build my query.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-203a.jpg" alt="BOTSv3 Question 5a" /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>index=botsv3 sourcetype="aws:cloudtrail" (eventName="PutBucketAcl" OR eventName="PutBucketPolicy")
</code></pre></div></div><p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-203b.jpg" alt="BOTSv3 Question 5b" /></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-203c.jpg" alt="BOTSv3 Question 5c" /></p> <h2 id="question-6-204">Question 6 (204)</h2> <p><strong>What is the name of the S3 bucket that was made publicly accessible?</strong></p> <p>For this one I simply viewed the raw text of the event and found the ‘bucketName’ field and its contents.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-204a.jpg" alt="BOTSv3 Question 6a" /></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-204b.jpg" alt="BOTSv3 Question 6a" /></p> <h2 id="question-7-205">Question 7 (205)</h2> <p><strong>What is the name of the text file that was successfully uploaded into the S3 bucket while it was publicly accessible? Answer guidance: Provide just the file name and extension, not the full path. (Example: filename.docx instead of /mylogs/web/filename.docx)</strong></p> <p>For this I used a simple query to search for any files with a ‘.txt’ extension from the S3 bucket. On the 6th event at 1:03:46 PM, we can see that the API is functioning because a REST.PUT.OBJECT request is sent and an HTTP 200 OK status code is sent back by the server.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-205a.jpg" alt="BOTSv3 Question 7a" /></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-205b.jpg" alt="BOTSv3 Question 7a" /></p> <h2 id="question-16-215">Question 16 (215)</h2> <p><strong>What is the FQDN of the endpoint that is running a different Windows operating system edition than the others?</strong></p> <p>I used a query to search for windows 10 machines in the index to see if I could find a suitable source to further explore. ‘operatingsystem’ looked to be a suitable target to gain the information I needed, and OS was the field I wished to sort by.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>index=botsv3 "windows 10"
</code></pre></div></div><p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-215a.jpg" alt="BOTSv3 Question 16a" /></p> <p>After that, I used a query to figure out which host was using which OS. ‘BSTOLL-L’ revealed itself as the only operating system running Windows 10 Enterprise.</p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-215b.jpg" alt="BOTSv3 Question 16b" /></p> <p>To actually figure out the FQDN of the host I ran a search for events corresponding with this machine in the windows event logs as FQDN will usually be there as ComputerName.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>index=botsv3 sourcetype="wineventlogs" host="BSTOLL-L"
</code></pre></div></div><p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-215c.jpg" alt="BOTSv3 Question 16c" /></p> <p><img src="/assets/images/personal/threat-hunting/botsv3/botsv3-215b.jpg" alt="BOTSv3 Question 16d" /></p> </article></div><hr class="dashed" /><div class="container"><div class="row"><div class="col-md-12"> <p class="categories" data-aos="fade-up"> </p></div></div><div class="recent" data-aos="fade-up"><div class=""> <h3>Recent Articles</h3></div><div class="recent-grid"><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-wazuh/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-wazuh.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Monitoring Suricata/Windows Logs With Wazuh</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-suricata/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Suricata Setup on pfSense with Snort Alerts</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest-pt.2/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 2</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 1</small></p></div></a></div></div></div></div></main><div id="search-container"></div><hr class="dashed" /><footer data-aos="fade-up"><div class="text-right"> <p class="copy"> <i class="fa fa-at"></i> 2018 <a class="rev" href="/">Blackcurrant</a> </p></div></footer></div></div></div></div><script src="/assets/js/jQuery.min.js"></script><script> $(document).ready(function () { $(".loader").hide(); });</script><script> (function () { var css = document.createElement("link"); css.href = "/assets/font-awesome-4.7.0/css/font-awesome.min.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css" /> </noscript><script> $("#search-input").keyup(function () { $("main").hide(); $("search-container").show(); if (!$("#search-input").val()) { $("main").show(); $("search-container").hide(); } });</script><script src="/assets/js/jekyll-search.min.js"></script><script> SimpleJekyllSearch({ searchInput: document.getElementById("search-input"), resultsContainer: document.getElementById("search-container"), searchResultTemplate: '<a class="nostyle" href="{url}"><div class="blog borders cards"><div class="image" style="background-image: url({image});"></div><div class="content"><h3 class="title">{title}</h3><p class="description">{description}</p></div></div></a>', noResultsText: "No results found", json: "/search.json", });</script><script> (function () { var css = document.createElement("link"); css.href = "https://unpkg.com/aos@2.3.1/dist/aos.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/animate-on-scroll/aos.min.css" /> </noscript><script src="/assets/animate-on-scroll/aos.min.js"></script><script> AOS.init({ duration: 600, once: true, disable: "mobile", });</script></body></html>