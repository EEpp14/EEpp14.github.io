<!-- This layout is used in all pages. Making changes here will efect all pages. We recommend not to change anything here. --> <!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="dns-prefetch" href="//fonts.googleapis.com" /><link rel="dns-prefetch" href="//google-analytics.com" /><link rel="dns-prefetch" href="//www.google-analytics.com" /><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com" /><link rel="dns-prefetch" href="//ajax.googleapis.com" /><link rel="dns-prefetch" href="//fonts.gstatic.com" /><link rel="dns-prefetch" href="https://.disqus.com/" /><title>VMWare Pro Homelab Suricata Setup on pfSense with Snort Alerts | My Portfolio</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="VMWare Pro Homelab Suricata Setup on pfSense with Snort Alerts" /><meta name="author" content="Ethan Epperson" /><meta property="og:locale" content="en_US" /><meta name="description" content="Installing Suricata Package Manager" /><meta property="og:description" content="Installing Suricata Package Manager" /><link rel="canonical" href="http://localhost:4000/blog/homelab-suricata/" /><meta property="og:url" content="http://localhost:4000/blog/homelab-suricata/" /><meta property="og:site_name" content="My Portfolio" /><meta property="og:image" content="http://localhost:4000/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-16T00:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg" /><meta property="twitter:title" content="VMWare Pro Homelab Suricata Setup on pfSense with Snort Alerts" /><script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ethan Epperson"},"dateModified":"2024-01-16T00:00:00-05:00","datePublished":"2024-01-16T00:00:00-05:00","description":"Installing Suricata Package Manager","headline":"VMWare Pro Homelab Suricata Setup on pfSense with Snort Alerts","image":"http://localhost:4000/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/homelab-suricata/"},"url":"http://localhost:4000/blog/homelab-suricata/"}</script><link rel="stylesheet" href="/assets/css/main-default.css" /><link id="color-scheme" rel="stylesheet" href="/assets/css/main-default.css" /><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-icon-60x60.png" /><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-icon-114x114.png" /><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-icon-152x152.png" /><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/android-icon-192x192.png" /><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><link rel="icon" href="/favicon.ico" type="image/x-icon" /><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" ></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script></head><body><div class="loader"><div class="lds-ring"><div></div><div></div><div></div><div></div></div></div><div class="wrapper"><div class="container-grid"><div class="sidebar"><div class="author-container shadow"><div class="author"> <a href="/"> <img src="/assets/images/headshots/professional-hs.jpg" width="100%" height="auto;" alt="My Portfolio"loading="lazy" /> </a></div><div class="about text-center"><h1 class="title"><a href="/">Ethan Epperson</a></h1></div><div class="bio text-center"><p class="m0">Cybersecurity Student | Let's Defend Together</p></div><hr class="dashed"><div class="social text-center"> <ul class="portfolio p0"> <li><a href="/projects/">Projects</a></li> <li><a href="/blog/">Blog</a></li> <li><a href="/contact/">Contact</a></li> </ul> <ul class="sm p0 m0a"> <li><a href="https://www.linkedin.com/in/ethan-epperson-8608b5277"><i class="fa fa-linkedin"></i></a></li> <li><a href="https://www.github.com/EEpp14"><i class="fa fa-github"></i></a></li> </ul></div></div></div><div class="main"><div class="main-container shadow"><div class="title-space"> <h1>VMWare Pro Homelab | Suricata Setup on pfSense with Snort Alerts</h1><div class="input-group mb-3" data-aos="zoom-in"> <input type="text" class="form-control border-right-0" id="search-input" /><div class="input-group-append"> <span class="input-group-text" ><i class="fa fa-search"></i ></span></div></div></div><hr class="dashed" /> <main> <ul class="breadcrumbs"> <li><a href="/">Home</a></li> <li> <a href="/blog" >Blog</a > </li> <li> <a href="#" >Homelab suricata</a > </li> </ul><div class="meta" data-aos="fade-up"> <p> <small> <span> <i class="fa fa-calendar" aria-hidden="true"></i> 16 Jan 2024&nbsp; </span> <span> <i class="fa fa-user" aria-hidden="true"></i> Ethan Epperson&nbsp; </span> <span> <i class="fa fa-clock-o" aria-hidden="true"></i> 3 mins read. </span> </small> </p></div><div class="featured-image rounded shadow" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg)" data-aos="zoom-in" ></div><div class="container"> <article> <ul class="toc"> <li><a href="#installing-suricata-package-manager">Installing Suricata Package Manager</a></li> <li><a href="#configuring-suricata-rules">Configuring Suricata Rules</a></li> <li><a href="#setting-up-interfaces">Setting Up Interfaces</a></li> </ul> <h2 id="installing-suricata-package-manager">Installing Suricata Package Manager</h2> <p>This section will be a rundown on how to install Suricata on pfSense and enable it for intrusion detection and network security monitoring. We will not be using inline intrusion prevention because we don’t want to block our traffic when we launch attacks. We will be using pfSense’s package manager to complete the installation. Go to ‘System’ → ‘Package Manager’ → ‘Available Packages’ and search for ‘Suricata’. Click ‘install’ and ‘confirm’. It’s that simple! Now we can move on to configuring the rules.</p> <p><img src="/assets/images/homelab/suricata-setup/suricata-install.jpg" alt="Suricata Package Installation" /></p> <h2 id="configuring-suricata-rules">Configuring Suricata Rules</h2> <p>Now that Suricata has been downloaded, head over to ‘Services’ → ‘Suricata’ → ‘Updates’. As we can see, all of our rule sets are not enabled. We need to change that. Go to ‘Global Settings’ and make sure that your chosen rules look identical to the images provided below. You can find the custom URL for ETOpen <a href="https://rules.emergingthreats.net/OPEN_download_instructions.html">here</a>. Use the highlighted option in the image provided below. Once you have everything in order, click save and then head back to ‘Updates’ to download and install the the rule sets. This may take some time.</p> <p><img src="/assets/images/homelab/suricata-setup/suricata-update.jpg" alt="Suricata Update Page" /></p> <p><img src="/assets/images/homelab/suricata-setup/suricata-etopen.jpg" alt="Suricata Package Installation" /></p> <p><img src="/assets/images/homelab/suricata-setup/suricata-rulelist.jpg" alt="Suricata Rulelist" /></p> <p><img src="/assets/images/homelab/suricata-setup/suricata-interval.jpg" alt="Suricata Interval Update Times" /></p> <p><img src="/assets/images/homelab/suricata-setup/suricata-update2.jpg" alt="Suricata Update Page with Rules" /></p> <h2 id="setting-up-interfaces">Setting Up Interfaces</h2> <p>Now that our rule sets have been updated we can start adding each interface to Suricata. We will start with LAN first. Go to ‘Interfaces’ and let’s add a new one. You might see a message that says we need to disable some network interface options. Let’s go to ‘System’ → ‘Advanced’ → ‘Networking’ and disable the three settings that pfSense flagged so that Suricata can function properly on our interfaces. This will require a reboot.</p> <p><img src="/assets/images/homelab/suricata-setup/suricata-warning.jpg" alt="Suricata Interface Warning Message" /></p> <p><img src="/assets/images/homelab/suricata-setup/suricata-disable.jpg" alt="Suricata Disabled Interface Rules" /></p> <p>Once that’s complete, head back to ‘Interfaces’ so we can setup each interface with the rule sets. We will start with the LAN. Click ‘add’ to add a new interface. Everything setting can remain as default EXCEPT make sure to enable ‘EVE JSON log’. leave the output type as ‘FILE’. Every other EVE setting can stay as is.</p> <p><img src="/assets/images/homelab/suricata-setup/suricata-lan.jpg" alt="Suricata LAN Configuration" /></p> <p>Make sure to avoid clicking ‘Block Offenders’ so we aren’t accidentally blocking intrusion attempts we try to conduct ourselves. It’s best practice to only turn on this feature after the Suricata rules have been tuned over a week or so to eliminate false positives. We are not really concerned with blocking anything for the purpose of this lab, but it’s important to note incase you want to mess around with it later.</p> <p>Once you have saved the LAN interface settings, copy them for OPT1 and OPT2. Your interfaces list should look like the image below.</p> <p><img src="/assets/images/homelab/suricata-setup/suricata-interfaces.jpg" alt="Suricata Disabled Interface Rules" /></p> <p>In each interface, we will need to select which rule sets the interface will load at startup. Enable all of rule sets by clicking ‘Select All’. Do this for each interface in the ‘xxx Categories’ menu, where ‘xxx’ is the currently selected interface. Make sure to save and apply. Selecting all will likely cause false positives, so you will need to whittle down the rules over time to eliminate these. I cannot walk you through this process as it occurs over time. There are plenty of useful guides for how to fine tune alerts in Suricata on Youtube.</p> <p><img src="/assets/images/homelab/suricata-setup/suricata-selectall.jpg" alt="Suricata Select All Rule sets" /></p> <p>Now we must enable Suricata on each interface in the ‘interfaces’ menu. For each interface, click the start button next to it, and voila, Suricata is now ingesting traffic and providing alerts for each interface. Below are some sample LAN alerts.</p> <p><img src="/assets/images/homelab/suricata-setup/suricata-enabled.jpg" alt="Suricata All Interfaces Enabled" /></p> <p><img src="/assets/images/homelab/suricata-setup/suricata-lan.jpg" alt="Suricata Example LAN Alert" /></p> <table> <tbody> <tr> <td>That’s all for this part. Soon, we will be installing Wazuh on Ubuntu. You can find the next part, ‘VMWare Pro Homelab</td> <td>Wazuh’, in the [blog] section of this site.</td> </tr> </tbody> </table> </article></div><hr class="dashed" /><div class="container"><div class="row"><div class="col-md-12"> <p class="categories" data-aos="fade-up"> <span ><a href="/categories/#blog" >Blog</a ></span > </p></div></div><div class="recent" data-aos="fade-up"><div class=""> <h3>Recent Articles</h3></div><div class="recent-grid"><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-wazuh/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-wazuh.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Monitoring Suricata/Windows Logs With Wazuh</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest-pt.2/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 2</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 1</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-dvwa/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-dvwa.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | DVWA Setup on Ubuntu Server</small></p></div></a></div></div></div></div></main><div id="search-container"></div><hr class="dashed" /><footer data-aos="fade-up"><div class="text-right"> <p class="copy"> <i class="fa fa-at"></i> 2018 <a class="rev" href="/">Blackcurrant</a> </p></div></footer></div></div></div></div><script src="/assets/js/jQuery.min.js"></script><script> $(document).ready(function () { $(".loader").hide(); });</script><script> (function () { var css = document.createElement("link"); css.href = "/assets/font-awesome-4.7.0/css/font-awesome.min.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css" /> </noscript><script> $("#search-input").keyup(function () { $("main").hide(); $("search-container").show(); if (!$("#search-input").val()) { $("main").show(); $("search-container").hide(); } });</script><script src="/assets/js/jekyll-search.min.js"></script><script> SimpleJekyllSearch({ searchInput: document.getElementById("search-input"), resultsContainer: document.getElementById("search-container"), searchResultTemplate: '<a class="nostyle" href="{url}"><div class="blog borders cards"><div class="image" style="background-image: url({image});"></div><div class="content"><h3 class="title">{title}</h3><p class="description">{description}</p></div></div></a>', noResultsText: "No results found", json: "/search.json", });</script><script> (function () { var css = document.createElement("link"); css.href = "https://unpkg.com/aos@2.3.1/dist/aos.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/animate-on-scroll/aos.min.css" /> </noscript><script src="/assets/animate-on-scroll/aos.min.js"></script><script> AOS.init({ duration: 600, once: true, disable: "mobile", });</script></body></html>