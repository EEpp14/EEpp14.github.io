<!-- This layout is used in all pages. Making changes here will efect all pages. We recommend not to change anything here. --> <!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="dns-prefetch" href="//fonts.googleapis.com" /><link rel="dns-prefetch" href="//google-analytics.com" /><link rel="dns-prefetch" href="//www.google-analytics.com" /><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com" /><link rel="dns-prefetch" href="//ajax.googleapis.com" /><link rel="dns-prefetch" href="//fonts.gstatic.com" /><link rel="dns-prefetch" href="https://.disqus.com/" /><title>VMWare Pro Homelab Kali &amp; Tsurugi | My Portfolio</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="VMWare Pro Homelab Kali &amp; Tsurugi" /><meta name="author" content="Ethan Epperson" /><meta property="og:locale" content="en_US" /><meta name="description" content="Creating the Management VMs" /><meta property="og:description" content="Creating the Management VMs" /><link rel="canonical" href="http://localhost:4000/blog/homelab-tsurugi-kali/" /><meta property="og:url" content="http://localhost:4000/blog/homelab-tsurugi-kali/" /><meta property="og:site_name" content="My Portfolio" /><meta property="og:image" content="http://localhost:4000/assets/images/thumbnails/homelab/Homelab-setup-guide-kali-tsurugi.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-09T00:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/images/thumbnails/homelab/Homelab-setup-guide-kali-tsurugi.jpg" /><meta property="twitter:title" content="VMWare Pro Homelab Kali &amp; Tsurugi" /><script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ethan Epperson"},"dateModified":"2024-01-09T00:00:00-05:00","datePublished":"2024-01-09T00:00:00-05:00","description":"Creating the Management VMs","headline":"VMWare Pro Homelab Kali &amp; Tsurugi","image":"http://localhost:4000/assets/images/thumbnails/homelab/Homelab-setup-guide-kali-tsurugi.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/homelab-tsurugi-kali/"},"url":"http://localhost:4000/blog/homelab-tsurugi-kali/"}</script><link rel="stylesheet" href="/assets/css/main-default.css" /><link id="color-scheme" rel="stylesheet" href="/assets/css/main-default.css" /><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-icon-60x60.png" /><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-icon-114x114.png" /><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-icon-152x152.png" /><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/android-icon-192x192.png" /><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><link rel="icon" href="/favicon.ico" type="image/x-icon" /><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" ></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script></head><body><div class="loader"><div class="lds-ring"><div></div><div></div><div></div><div></div></div></div><div class="wrapper"><div class="container-grid"><div class="sidebar"><div class="author-container shadow"><div class="author"> <a href="/"> <img src="/assets/images/headshots/professional-hs.jpg" width="100%" height="auto;" alt="My Portfolio"loading="lazy" /> </a></div><div class="about text-center"><h1 class="title"><a href="/">Ethan Epperson</a></h1></div><div class="bio text-center"><p class="m0">Cybersecurity Student | Let's Defend Together</p></div><hr class="dashed"><div class="social text-center"> <ul class="portfolio p0"> <li><a href="/projects/">Projects</a></li> <li><a href="/blog/">Blog</a></li> <li><a href="/contact/">Contact</a></li> </ul> <ul class="sm p0 m0a"> <li><a href="https://www.linkedin.com/in/ethan-epperson-8608b5277"><i class="fa fa-linkedin"></i></a></li> <li><a href="https://www.github.com/EEpp14"><i class="fa fa-github"></i></a></li> </ul></div></div></div><div class="main"><div class="main-container shadow"><div class="title-space"> <h1>VMWare Pro Homelab | Kali & Tsurugi</h1><div class="input-group mb-3" data-aos="zoom-in"> <input type="text" class="form-control border-right-0" id="search-input" /><div class="input-group-append"> <span class="input-group-text" ><i class="fa fa-search"></i ></span></div></div></div><hr class="dashed" /> <main> <ul class="breadcrumbs"> <li><a href="/">Home</a></li> <li> <a href="/blog" >Blog</a > </li> <li> <a href="#" >Homelab tsurugi kali</a > </li> </ul><div class="meta" data-aos="fade-up"> <p> <small> <span> <i class="fa fa-calendar" aria-hidden="true"></i> 09 Jan 2024&nbsp; </span> <span> <i class="fa fa-user" aria-hidden="true"></i> Ethan Epperson&nbsp; </span> <span> <i class="fa fa-clock-o" aria-hidden="true"></i> 6 mins read. </span> </small> </p></div><div class="featured-image rounded shadow" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-kali-tsurugi.jpg)" data-aos="zoom-in" ></div><div class="container"> <article> <ul class="toc"> <li><a href="#creating-the-management-vms">Creating the Management VMs</a></li> <li><a href="#static-dhcp-allocation-in-webconfigurator">Static DHCP Allocation in webConfigurator</a></li> <li><a href="#installing-tsurugi-linux-os">Installing Tsurugi Linux OS</a></li> </ul> <h2 id="creating-the-management-vms">Creating the Management VMs</h2> <p>Since we already covered how to use the ‘New Virtual Machine Wizard’ when creating the pfSense machine, we will not be going through those steps. I will provide the specifications of each VM so that you can create them yourself. However, we will cover DHCP static allocations in the webConfigurator as well as OS installations. If you never obtained the ISOs in the introduction post, then go and grab them now. The images below contain the minimum requirements for each machine. We can always bump these numbers up if we need to, but we cannot reduce something like disk space in VMWare, but feel free to better tailor CPU processors/cores, disk size, and RAM to your own hardware.</p> <p><img src="/assets/images/homelab/management-vms-setup/setup-tsurugi.jpg" alt="Tsurugi Linux Requirements" /></p> <p><img src="/assets/images/homelab/management-vms-setup/setup-kali.jpg" alt="Kali Linux Requirements" /></p> <h2 id="static-dhcp-allocation-in-webconfigurator">Static DHCP Allocation in webConfigurator</h2> <p>We will now configure the DHCP server to statically assign IPs for each of our VMs. Remember that these are the assignments we’ve made thus far.</p> <ul> <li>Our LAN (Management Network) is assigned to 10.0.11.0, OPT1 (IPS 1 &amp; 2 Networks) to 10.0.12.0, and OPT2 (AD network) to 10.0.13.0.</li> <li>The LAN interface to 10.0.11.1, the OPT1 interface to 10.0.12.1, and the OPT2 interface to 10.0.13.1.</li> <li>The vNIC for vmnet1 is assigned as 10.0.11.2.</li> <li>We also set the dynamic DHCP ranges to 10.0.11.10 - 10.0.11.254 for LAN, 10.0.12.10 - 10.0.12.254 for OPT1, and 10.0.13.10 - 10.0.13.254 for OPT2.</li> </ul> <p>This means that we will have 7 potential static IP addresses remaining for the LAN segment (10.0.11.3 - 10.0.11.9), 8 for OPT1 (10.0.12.2 - 10.0.12.9), and 8 for OPT2 (10.0.13.2 - 10.0.13.9). If we ever want more machines, we can tighten the range of dynamically assigned IPs to allow for a higher static range. Make sure you have your MAC addresses you just generated because we will be needing those. Let’s go ahead and map out which machines are going to be assigned to which IP for the management (LAN) network:</p> <ul> <li><strong>LAN static DHCP mappings</strong>:<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># We will assign the Wazuh IP now and install this VM later
10.0.11.3 - SIEM (Wazuh) 
10.0.11.4 - Tsurugi
10.0.11.5 - Kali
</code></pre></div></div></li> </ul> <p>Now that we understand which IP is mapped to which machine, let’s go to ‘Services’ → ‘DHCP Server’. On the ‘LAN’, ‘OPT1’, and ‘OPT2’ tabs, make sure that the ranges are to your desire and no mistakes were made. I accidentally made a typo in the command line assignments for the LAN range (ending at ‘.245’ instead of ‘.254’) so I fixed that. DHCP should be enabled by default for all. On the ‘LAN’ tab, head down to ‘DHCP Static Mappings on LAN’ at the bottom of the page. We need to make sure that the MAC address of the correct VM aligns with the IP address we want to assign to it. Below is an example allocation.</p> <p><img src="/assets/images/homelab/management-vms-setup/dhcp-example.jpg" alt="Example DHCP Static Allocation" /></p> <p>Once you’ve added the remaining two IPs, the ‘Static DHCP Mapping on LAN’ section should look like should look like the image below.</p> <p><img src="/assets/images/homelab/management-vms-setup/dhcp-lan.jpg" alt="DHCP Static Allocations For LAN" /></p> <h2 id="installing-tsurugi-linux-os">Installing Tsurugi Linux OS</h2> <p>Power on the Tsurugi machine and then select ‘Install Tsurugi(GUI Mode)’. Once it’s done loading, click on the icon that reads ‘Displays’. Here we can change the screen resolution to ‘1680 x 1050’. Click on ‘Install Tsurugi Linux 2023.2’. A warning will pop up, just click ‘Yes’ to continue. Choose your language and keyboard settings. On the updates screen choose the normal installation and you can choose to install third-party software for graphics and hardware if you so desire. For the type leave it as is and erase the disk when prompted. Choose your location, I will not be showing mine as to not doxx myself. You’ll then need to create a profile and name your machine. Once this is done, you should be ready to install. It might take a while, so get cozy in the meantime. Once its done, we can remove the installation media and restart. You will be prompted to login. Now we can test connectivity as well as update and install packages. Now you have access to a full range of DFIR tools at your disposal.</p> <p><img src="/assets/images/homelab/management-vms-setup/tsurugi-display.jpg" alt="Tsurugi Resolution" /></p> <p><img src="/assets/images/homelab/management-vms-setup/tsurugi-language.jpg" alt="Tsurugi Install Wizard Language" /></p> <p><img src="/assets/images/homelab/management-vms-setup/tsurugi-keyboard.jpg" alt="Tsurugi Install Wizard Keyboard" /></p> <p><img src="/assets/images/homelab/management-vms-setup/tsurugi-updates.jpg" alt="Tsurugi Install Wizard Updates" /></p> <p><img src="/assets/images/homelab/management-vms-setup/tsurugi-type.jpg" alt="Tsurugi Install Wizard Type" /></p> <p><img src="/assets/images/homelab/management-vms-setup/tsurugi-who.jpg" alt="Tsurugi Install Wizard Who" /></p> <h1 id="installing-kali-linux-os">Installing Kali Linux OS</h1> <p>For Kali, choose the ‘Graphic Installer’ option. Choose your language, region, and keyboard configurations. Wait for the installer for a moment. On the next screen, change the hostname to whatever you wish. For the domain name make sure it aligns with the domain you setup in the webConfigurator. On the next three screens, give your name and create a username/password. After that, configure the timezone for the clock settings. For the disk option, choose ‘Guided - Use entire disk’ and then select SCSI3. When asked how the disk is to be partitioned, choose ‘All files in one partition’. On the next two pages, click finish and then select yes. The disks will then be partitioned and the base system installed. We will then be asked which software we want to install. Choose whichever packages you like, but I’d leave it at the default. Software will then be installed. This will probably take some time. On the grub boot loader screen choose yes and then on the next select ‘/dev/sda’. The grub boot loader will then be installed and that should be it! Kali is now installed, so once more we can reboot to test connectivity and update packages.</p> <p><img src="/assets/images/homelab/management-vms-setup/kali-install.jpg" alt="Kali Install Choice" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-language.jpg" alt="Kali Install Language" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-location.jpg" alt="Kali Install Location" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-keyboard.jpg" alt="Kali Install Keyboard" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-host.jpg" alt="Kali Install Hostname" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-domain.jpg" alt="Kali Install Domain Name" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-newuser.jpg" alt="Kali Install New User" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-user.jpg" alt="Kali Install Username" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-pass.jpg" alt="Kali Install Password" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-disk.jpg" alt="Kali Install Entire Disk" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-scsi3.jpg" alt="Kali Install SCSI3" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-partition.jpg" alt="Kali Install Partition" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-finishpart.jpg" alt="Kali Install Finish" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-confirm.jpg" alt="Kali Install Confirm" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-software.jpg" alt="Kali Install Software" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-grub.jpg" alt="Kali Install Grub Boot Loader" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-dev.jpg" alt="Kali Install Grub Location" /></p> <p><img src="/assets/images/homelab/management-vms-setup/kali-reboot.jpg" alt="Kali Install Reboot" /></p> <p>With that, the management network VMs are all setup! Don’t forget to take snapshots of all of them at this point. Later, we will be installing Wazuh on the Ubuntu server to act as our SIEM and ingest logs for from the firewall.</p> <table> <tbody> <tr> <td>we will now move on to importing the isolated VMs and preparing an Ubuntu server for DVWA. You can find it by going to ‘VMWare Pro Homelab</td> <td>Metasploitable2 &amp; Vulnhub’ in the [blog] section of this site.</td> </tr> </tbody> </table> </article></div><hr class="dashed" /><div class="container"><div class="row"><div class="col-md-12"> <p class="categories" data-aos="fade-up"> <span ><a href="/categories/#blog" >Blog</a ></span > </p></div></div><div class="recent" data-aos="fade-up"><div class=""> <h3>Recent Articles</h3></div><div class="recent-grid"><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-wazuh/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-wazuh.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Monitoring Suricata/Windows Logs With Wazuh</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-suricata/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Suricata Setup on pfSense with Snort Alerts</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest-pt.2/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 2</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 1</small></p></div></a></div></div></div></div></main><div id="search-container"></div><hr class="dashed" /><footer data-aos="fade-up"><div class="text-right"> <p class="copy"> <i class="fa fa-at"></i> 2018 <a class="rev" href="/">Blackcurrant</a> </p></div></footer></div></div></div></div><script src="/assets/js/jQuery.min.js"></script><script> $(document).ready(function () { $(".loader").hide(); });</script><script> (function () { var css = document.createElement("link"); css.href = "/assets/font-awesome-4.7.0/css/font-awesome.min.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css" /> </noscript><script> $("#search-input").keyup(function () { $("main").hide(); $("search-container").show(); if (!$("#search-input").val()) { $("main").show(); $("search-container").hide(); } });</script><script src="/assets/js/jekyll-search.min.js"></script><script> SimpleJekyllSearch({ searchInput: document.getElementById("search-input"), resultsContainer: document.getElementById("search-container"), searchResultTemplate: '<a class="nostyle" href="{url}"><div class="blog borders cards"><div class="image" style="background-image: url({image});"></div><div class="content"><h3 class="title">{title}</h3><p class="description">{description}</p></div></div></a>', noResultsText: "No results found", json: "/search.json", });</script><script> (function () { var css = document.createElement("link"); css.href = "https://unpkg.com/aos@2.3.1/dist/aos.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/animate-on-scroll/aos.min.css" /> </noscript><script src="/assets/animate-on-scroll/aos.min.js"></script><script> AOS.init({ duration: 600, once: true, disable: "mobile", });</script></body></html>