<!-- This layout is used in all pages. Making changes here will efect all pages. We recommend not to change anything here. --> <!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="dns-prefetch" href="//fonts.googleapis.com" /><link rel="dns-prefetch" href="//google-analytics.com" /><link rel="dns-prefetch" href="//www.google-analytics.com" /><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com" /><link rel="dns-prefetch" href="//ajax.googleapis.com" /><link rel="dns-prefetch" href="//fonts.gstatic.com" /><link rel="dns-prefetch" href="https://.disqus.com/" /><title>VMWare Pro Homelab Introduction | My Portfolio</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="VMWare Pro Homelab Introduction" /><meta name="author" content="Ethan Epperson" /><meta property="og:locale" content="en_US" /><meta name="description" content="Welcome to the Homelab Series" /><meta property="og:description" content="Welcome to the Homelab Series" /><link rel="canonical" href="https://eepp14.github.io/blog/homelab-intro/" /><meta property="og:url" content="https://eepp14.github.io/blog/homelab-intro/" /><meta property="og:site_name" content="My Portfolio" /><meta property="og:image" content="https://eepp14.github.io/assets/images/thumbnails/homelab/Homelab-setup-guide.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-04T00:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://eepp14.github.io/assets/images/thumbnails/homelab/Homelab-setup-guide.jpg" /><meta property="twitter:title" content="VMWare Pro Homelab Introduction" /><script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ethan Epperson"},"dateModified":"2024-01-04T00:00:00-05:00","datePublished":"2024-01-04T00:00:00-05:00","description":"Welcome to the Homelab Series","headline":"VMWare Pro Homelab Introduction","image":"https://eepp14.github.io/assets/images/thumbnails/homelab/Homelab-setup-guide.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://eepp14.github.io/blog/homelab-intro/"},"url":"https://eepp14.github.io/blog/homelab-intro/"}</script><link rel="stylesheet" href="/assets/css/main-default.css" /><link id="color-scheme" rel="stylesheet" href="/assets/css/main-default.css" /><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-icon-60x60.png" /><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-icon-114x114.png" /><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-icon-152x152.png" /><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/android-icon-192x192.png" /><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><link rel="icon" href="/favicon.ico" type="image/x-icon" /><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" ></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script></head><body><div class="loader"><div class="lds-ring"><div></div><div></div><div></div><div></div></div></div><div class="wrapper"><div class="container-grid"><div class="sidebar"><div class="author-container shadow"><div class="author"> <a href="/"> <img src="/assets/images/headshots/professional-hs.jpg" width="100%" height="auto;" alt="My Portfolio"loading="lazy" /> </a></div><div class="about text-center"><h1 class="title"><a href="/">Ethan Epperson</a></h1></div><div class="bio text-center"><p class="m0">Cybersecurity Student | Let's Defend Together</p></div><hr class="dashed"><div class="social text-center"> <ul class="portfolio p0"> <li><a href="/projects/">Projects</a></li> <li><a href="/blog/">Blog</a></li> <li><a href="/contact/">Contact</a></li> </ul> <ul class="sm p0 m0a"> <li><a href="https://www.linkedin.com/in/ethan-epperson-8608b5277"><i class="fa fa-linkedin"></i></a></li> <li><a href="https://www.github.com/EEpp14"><i class="fa fa-github"></i></a></li> </ul></div></div></div><div class="main"><div class="main-container shadow"><div class="title-space"> <h1>VMWare Pro Homelab | Introduction</h1><div class="input-group mb-3" data-aos="zoom-in"> <input type="text" class="form-control border-right-0" id="search-input" /><div class="input-group-append"> <span class="input-group-text" ><i class="fa fa-search"></i ></span></div></div></div><hr class="dashed" /> <main> <ul class="breadcrumbs"> <li><a href="/">Home</a></li> <li> <a href="/blog" >Blog</a > </li> <li> <a href="#" >Homelab intro</a > </li> </ul><div class="meta" data-aos="fade-up"> <p> <small> <span> <i class="fa fa-calendar" aria-hidden="true"></i> 04 Jan 2024&nbsp; </span> <span> <i class="fa fa-user" aria-hidden="true"></i> Ethan Epperson&nbsp; </span> <span> <i class="fa fa-clock-o" aria-hidden="true"></i> 8 mins read. </span> </small> </p></div><div class="featured-image rounded shadow" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide.jpg)" data-aos="zoom-in" ></div><div class="container"> <article> <ul class="toc"> <li><a href="#welcome-to-the-homelab-series">Welcome to the Homelab Series</a></li> <li><a href="#resources">Resources</a></li> <li><a href="#topology-diagram--explanation">Topology Diagram &amp; Explanation</a></li> </ul> <h1 id="welcome-to-the-homelab-series">Welcome to the Homelab Series</h1> <p>Today, I will be starting the process of building my new red and blue team lab from scratch and planning out the network topology. I wanted a place where I could document the building steps so that they can be publicly available for anyone interested in building their own lab environment. Undertaking this project will be an excellent way for myself and others to gain hands-on experience with the following:</p> <ul> <li>Proper routing and network isolation techniques</li> <li>Firewall rule creation and proper order</li> <li>Virtual machine creation via hosted hypervisor</li> <li>OS installations for a variety of systems</li> <li>Setting up network services such as DNS, NTP, and DHCP</li> <li>Setting up a SIEM with agents for ingesting logs</li> <li>Deploying an IDS on a firewall</li> <li>Setting up an Active Directory Forest environment</li> </ul> <p>This lab environment is my own custom variation of the base lab built in Tony Robinson’s ‘Building Virtual Machine Labs: A Hands-On Guide (Second Edition)’. If you would like to purchase the text, you can find it here on <a href="https://www.amazon.com/Building-Virtual-Machine-Labs-Hands/dp/B09GZJPYFX">Amazon</a>.</p> <p>Why go for both red team and blue team you might ask? I think it only makes sense because each security domain does not exist in a bubble. Learning blue team fundamentals can help build on the concepts and skills involved in red team and vice-versa. If you’re someone like myself who has interest in learning DFIR, SOC, and penetration testing, then you are in luck. This lab will arm you with the tools needed to get hands-on practical experience in each specialization.</p> <p>I at first considered buying a cheap used Intel NUC or BeeLink mini-pc to act as a home server that I could run VMWare ESxI, Proxmox, or some other bare-metal hypervisor on top of, but I want to keep this lab as cost-free possible for any new home lab builders. I also considered converting an old gaming PC of mine into a server, but then I would need to upgrade the RAM, not to mention I had wanted to give that PC away. I want to offer a solution that you can start <em>TODAY</em> with nothing more than your home workstation. The best solution then was to use a hosted hypervisor in the form of VMWare Workstation 17 Professional.</p> <p>I already own the application, but the license fee for VMWare Workstation Pro currently runs at $200 USD. “Now wait a minute, I thought this was going to be free?”, is a question you might be asking right about now. Technically, it does cost money, but VMWare offers a free 30-day trial for Pro that will give you access to it’s full suite of features. After the trial has expired, you can simply downgrade as we really only need Pro’s features for setting up virtual networks.</p> <p>These are the specs for my own PC:</p> <table> <thead> <tr> <th style="text-align: left">Hardware</th> <th style="text-align: left">Specifications</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">CPU</td> <td style="text-align: left">AMD Ryzen 7 5800x</td> </tr> <tr> <td style="text-align: left">GPU</td> <td style="text-align: left">Nvidia Geforce RTX 3060 ti</td> </tr> <tr> <td style="text-align: left">RAM</td> <td style="text-align: left">32GB DDR5-5200Mhz</td> </tr> <tr> <td style="text-align: left">DISK</td> <td style="text-align: left">1TB SSD</td> </tr> <tr> <td style="text-align: left">OS</td> <td style="text-align: left">Windows 10 Home</td> </tr> </tbody> </table> <p>and these are the minimum requirements as follows:</p> <table> <thead> <tr> <th style="text-align: left">Hardware</th> <th style="text-align: left">Minimum Specifications</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">CPU</td> <td style="text-align: left">Quad-core processor that supports virtualization through BIOS UEFI, the more cores the better</td> </tr> <tr> <td style="text-align: left">GPU</td> <td style="text-align: left">Whatever works, preferably a modern discrete, GPU over an integrated solution</td> </tr> <tr> <td style="text-align: left">RAM</td> <td style="text-align: left">32 GB, although 16 GB could work if you don’t plan to run every VM in in the lab at once.</td> </tr> <tr> <td style="text-align: left">DISK</td> <td style="text-align: left">At least 512GB SSD, preferably 1TB or more for future proofing and perhaps another HDD storage device for holding our VMs and VM data</td> </tr> <tr> <td style="text-align: left">OS</td> <td style="text-align: left">Windows 10 or better, any modern Linux distro although this setup guide will focus on Windows 11 you could adapt it to your own standard</td> </tr> </tbody> </table> <h1 id="resources">Resources</h1> <p>Below are the links to all of the resources I plan on using in this environment. I would gather all of them now so that it won’t be a headache coming back to this post when you need one.</p> <p><a href="https://obsidian.md/download">Obsidian</a> is a great freemium note-taking application that uses Markdown. It is where I will be keeping technical notes for my networks and VMs. I recommend that you take notes along the way as well.</p> <p><a href="https://app.diagrams.net/">Draw.io</a> is the web application I used to construct my network diagram. It’s very user friendly and offers a wealth of great features specifically for constructing technical diagram.</p> <p><a href="https://www.vmware.com/products/workstation-pro.html">VMWare Workstation 17 Pro</a> is the hypervisor we will be using for this homelab. Download it from the link above</p> <p><a href="https://www.pfsense.org/download/">pfSense</a> is a router/firewall software solution that is based on FreeBSD. We will be spinning it up on a VM. The Community Edition is free and has everything that we should need.</p> <p><a href="https://documentation.wazuh.com/current/deployment-options/virtual-machine/virtual-machine.html">Wazuh</a> is a free, open source SIEM solution that offers an easy-to-use security dashboard with a host of various features. We will be using it to ingest events/logs from Suricata/Windows. The preconfigured OVA is the installation we want.</p> <p><a href="https://www.kali.org/get-kali/#kali-installer-images">Kali Linux</a> is an offensive focused, Debian-based distribution of Linux. Any security homelab is going to want this in their arsenal. The 64-bit installer image is the one you want.</p> <p><a href="https://sourceforge.net/projects/metasploitable/files/Metasploitable2/">Metasploitable2</a> is an intentionally vulnerable Linux VM which we will be setting up in our isolated network.</p> <p><a href="https://github.com/digininja/DVWA">Damn Vulnerable Web Application</a>, or DVWA, is just as it states. It’s a damn vulnerable web application which is used for web hacking.</p> <p><a href="https://ubuntu.com/download/server">Ubuntu Server 22.04.3 LTS</a> will be used as the OS DVWA is built upon.</p> <p><a href="https://www.vulnhub.com/">VulnHub</a> offers a range of vulnerable by design VMs. We are going to include one in our isolated network. Feel free to choose your own. I will be using <a href="https://www.vulnhub.com/entry/symfonos-1,322/">Symfono:1</a>.</p> <p><a href="https://www.microsoft.com/en-us/evalcenter/download-windows-server-2019">Windows Server 2019</a> will be used as the domain controller in the active directory network. Microsoft offers free ISOs for Windows Server and Enterprise edition. You will have to register an account with Microsoft Evaluation Center before you can download.</p> <p><a href="https://www.microsoft.com/en-us/software-download/windows10ISO">Windows 10 Enterprise</a> we will have two windows 10 client machines in the AD network.</p> <h1 id="topology-diagram--explanation">Topology Diagram &amp; Explanation</h1> <p><img src="/assets/images/homelab/intro-post/network-topology.jpg" alt="My Homelab Topology" /></p> <p>This homelab will consist of ten virtual machines spread across three sub-networks that we will allocate via pfSense’s routing capabilities. I will explain each segment in more detail below.</p> <ol> <li>pfSense Virtual Router &amp; Firewall</li> </ol> <p>The pfSense virtual machine is the glue of this lab. We will have three separate VMnets created through VMWare’s virtual network editor that will correspond with LAN (10.0.11.1), OPT1 (10.0.12.1), and OPT2 (10.0.13.1) adapters within pfSense. A bridged connection on the ethernet/wireless adapter of choice will be used to bridge the connection to our home network. Suricata will be deployed as a service on pfSense’s web interface in order to ingest logs from each subnet. The pfSense machine will act an agent for our Wazuh SIEM to forward those logs to the Wazuh server. The LAN VMNet will employ a host virtual network adapter at 10.0.11.2.</p> <ol> <li>LAN - Management Subnet</li> </ol> <p>This subnet consists of three machines. Kali Linux, Tsurugi Linux, and a Wazuh server. The Kali Linux machine (10.0.11.5) is the living, beating heart of the management network. We will be able to monitor security events through the Wazuh dashboard or launch attacks on the machines in the vulnerable and active directory subnets from Kali. The Wazuh server (10.0.11.3) will be configured as an all-in one solution with server, indexer, and dashboard on one machine. Tsurugi Linux (10.0.11.4) will be used for performing various DFIR tasks. Firewall rules will be configured to allow outbound HTTP/HTTPS connections as well as allowing the Kali machine access to other internal subnet machines. This subnet will occupy the address range of 10.0.11.0/24.</p> <ol> <li>OPT1 - Vulnerable Subnet</li> </ol> <p>This subnet consists of three more machines. One for our Apache2, DVWA web server (10.0.12.2), one for MetaSploitable2 (10.0.12.3), and the last for our Symfonos:1 VulnHub virtual machine (10.0.12.4). Network isolation will be enforced via firewall rules preventing outbound connection from this subnet as these machines are highly vulnerable. The DVWA server will accessible from Kali for the purpose of launching web exploits. The VulnHub and MetaSploitable boxes will also be used for various red team, penetration testing purposes. This subnet will occupy the address range of 10.0.12.0/24.</p> <ol> <li>OPT2 - AD Subnet</li> </ol> <p>This subnet will house another three machines. A Windows Server 2019 installation that will be deployed as a domain controller and certificate authority (10.0.13.2) and two Windows 10 Enterprise client machines (10.0.13.3). The windows clients will be joined to the domain to create a vulnerable AD forest for ethical hacking. Several service accounts will be created, several ports will be opened, and the firewall on the DC will be disabled to allow for a wide variety of attack avenues. pfSense will act as the default gateway for our DC. The DC will also act as an agent for our Wazuh server so that we can view Windows Event Logs in the Wazuh dashboard. This subnet will occupy the address range of 10.0.13.0/24.</p> <table> <tbody> <tr> <td>We are ready to begin the project. You can find the first post, ‘VMWare Pro Homelab</td> <td>VMWare Setup’, in the [blog] section of this site.</td> </tr> </tbody> </table> </article></div><hr class="dashed" /><div class="container"><div class="row"><div class="col-md-12"> <p class="categories" data-aos="fade-up"> <span ><a href="/categories/#blog" >Blog</a ></span > </p></div></div><div class="recent" data-aos="fade-up"><div class=""> <h3>Recent Articles</h3></div><div class="recent-grid"><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-wazuh/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-wazuh.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Monitoring Suricata/Windows Logs With Wazuh</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-suricata/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-suricata.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Suricata Setup on pfSense with Snort Alerts</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest-pt.2/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 2</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/homelab-ad-forest/"><div class="cards"><div class="image rounded" style="background-image: url(/assets/images/thumbnails/homelab/Homelab-setup-guide-windows.jpg)" ></div><p class="title"><small>VMWare Pro Homelab | Active Directory Forest Setup pt. 1</small></p></div></a></div></div></div></div></main><div id="search-container"></div><hr class="dashed" /><footer data-aos="fade-up"><div class="text-right"> <p class="copy"> <i class="fa fa-at"></i> 2018 <a class="rev" href="/">Blackcurrant</a> </p></div></footer></div></div></div></div><script src="/assets/js/jQuery.min.js"></script><script> $(document).ready(function () { $(".loader").hide(); });</script><script> (function () { var css = document.createElement("link"); css.href = "/assets/font-awesome-4.7.0/css/font-awesome.min.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css" /> </noscript><script> $("#search-input").keyup(function () { $("main").hide(); $("search-container").show(); if (!$("#search-input").val()) { $("main").show(); $("search-container").hide(); } });</script><script src="/assets/js/jekyll-search.min.js"></script><script> SimpleJekyllSearch({ searchInput: document.getElementById("search-input"), resultsContainer: document.getElementById("search-container"), searchResultTemplate: '<a class="nostyle" href="{url}"><div class="blog borders cards"><div class="image" style="background-image: url({image});"></div><div class="content"><h3 class="title">{title}</h3><p class="description">{description}</p></div></div></a>', noResultsText: "No results found", json: "/search.json", });</script><script> (function () { var css = document.createElement("link"); css.href = "https://unpkg.com/aos@2.3.1/dist/aos.css"; css.rel = "stylesheet"; css.type = "text/css"; document.getElementsByTagName("head")[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/animate-on-scroll/aos.min.css" /> </noscript><script src="/assets/animate-on-scroll/aos.min.js"></script><script> AOS.init({ duration: 600, once: true, disable: "mobile", });</script></body></html>